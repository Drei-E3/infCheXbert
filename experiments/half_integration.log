lr= 5e-5
Batch size:  16
The number of training instances: 99371
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 100, Avg loss: 1.406
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 200, Avg loss: 1.403
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 300, Avg loss: 1.405
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 400, Avg loss: 1.404
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 500, Avg loss: 1.408
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 600, Avg loss: 1.401
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 700, Avg loss: 1.401
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 800, Avg loss: 1.406
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 900, Avg loss: 1.411
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 1000, Avg loss: 1.400
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 1100, Avg loss: 1.406
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 1200, Avg loss: 1.408
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 1300, Avg loss: 1.402
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 1400, Avg loss: 1.400
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 1500, Avg loss: 1.403
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 1600, Avg loss: 1.404
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 1700, Avg loss: 1.404
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 1800, Avg loss: 1.404
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 1900, Avg loss: 1.403
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 2000, Avg loss: 1.406
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 2100, Avg loss: 1.408
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 2200, Avg loss: 1.408
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 2300, Avg loss: 1.410
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 2400, Avg loss: 1.408
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 2500, Avg loss: 1.408
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 2600, Avg loss: 1.405
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 2700, Avg loss: 1.409
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 2800, Avg loss: 1.403
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 2900, Avg loss: 1.401
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 3000, Avg loss: 1.403
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 3100, Avg loss: 1.402
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 3200, Avg loss: 1.411
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 3300, Avg loss: 1.404
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 3400, Avg loss: 1.409
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 3500, Avg loss: 1.404
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 3600, Avg loss: 1.403
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 3700, Avg loss: 1.406
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 3800, Avg loss: 1.410
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 3900, Avg loss: 1.406
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 4000, Avg loss: 1.404
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 4100, Avg loss: 1.398
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 4200, Avg loss: 1.396
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 4300, Avg loss: 1.403
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 4400, Avg loss: 1.408
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 4500, Avg loss: 1.409
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 4600, Avg loss: 1.400
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 4700, Avg loss: 1.400
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 4800, Avg loss: 1.408
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 4900, Avg loss: 1.410
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 5000, Avg loss: 1.406
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 5100, Avg loss: 1.402
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 5200, Avg loss: 1.407
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 5300, Avg loss: 1.403
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 5400, Avg loss: 1.412
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 5500, Avg loss: 1.396
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 5600, Avg loss: 1.411
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 5700, Avg loss: 1.406
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 5800, Avg loss: 1.399
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 5900, Avg loss: 1.406
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 6000, Avg loss: 1.406
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 6100, Avg loss: 1.407
labelsname: label_Atelectasis, Epoch id: 1, Training steps: 6200, Avg loss: 1.408
Start evaluation on test dataset.
Loading sentences from ./datasets/CheXpert/impression/test.csv
There are 33124 sentence in total. We use 1 processes to inject knowledge into sentences.
Progress of process 0: 0/33124
Progress of process 0: 10000/33124
Progress of process 0: 20000/33124
Progress of process 0: 30000/33124
tensor([[    2,  4003,     1,  ...,     0,     0,     0],
        [    2,     1,     1,  ...,     0,     0,     0],
        [    2,  7868,     1,  ...,     0,     0,     0],
        ...,
        [    2,     1,  3800,  ...,     0,     0,     0],
        [    2,     1,  1012,  ...,     0,     0,     0],
        [    2,     1, 17749,  ...,     0,     0,     0]], device='mps:0')
torch.Size([16, 256])
tensor([[[1, 1, 0,  ..., 0, 0, 0],
         [1, 1, 1,  ..., 0, 0, 0],
         [0, 1, 1,  ..., 0, 0, 0],
         ...,
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0]],

        [[1, 1, 1,  ..., 0, 0, 0],
         [1, 1, 1,  ..., 0, 0, 0],
         [1, 1, 1,  ..., 0, 0, 0],
         ...,
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0]],

        [[1, 1, 0,  ..., 0, 0, 0],
         [1, 1, 1,  ..., 0, 0, 0],
         [0, 1, 1,  ..., 0, 0, 0],
         ...,
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0]],

        ...,

        [[1, 1, 1,  ..., 0, 0, 0],
         [1, 1, 1,  ..., 0, 0, 0],
         [1, 1, 1,  ..., 0, 0, 0],
         ...,
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0]],

        [[1, 1, 1,  ..., 0, 0, 0],
         [1, 1, 1,  ..., 0, 0, 0],
         [1, 1, 1,  ..., 0, 0, 0],
         ...,
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0]],

        [[1, 1, 1,  ..., 0, 0, 0],
         [1, 1, 1,  ..., 0, 0, 0],
         [1, 1, 1,  ..., 0, 0, 0],
         ...,
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0],
         [0, 0, 0,  ..., 0, 0, 0]]], device='mps:0')
torch.Size([16, 256, 256])
labelsname: label_Atelectasis, Label_value 0: 0.791, 0.791, 0.791
labelsname: label_Atelectasis, Label_value 1: 0.166, 0.166, 0.166
labelsname: label_Atelectasis, Label_value 2: 0.000, 0.000, 0.000
labelsname: label_Atelectasis, Label_value 3: 0.052, 0.052, 0.052
Acc. (Correct/Total): 0.1466 (4856/33124) 
Start evaluation on evaluation dataset.
Loading sentences from ./datasets/CheXpert/impression/validation.csv
There are 33124 sentence in total. We use 1 processes to inject knowledge into sentences.
Progress of process 0: 0/33124
Progress of process 0: 10000/33124
Progress of process 0: 20000/33124
Progress of process 0: 30000/33124
The number of evaluation instances:  33124
Confusion matrix of {label_name}:
tensor([[ 3259,   682,    16,   174],
        [  482,    98,     5,    26],
        [  470,   148,     0,    28],
        [20537,  5567,   183,  1449]])
Report precision, recall, and f1:
labelsname: label_Atelectasis, Label_value 0: 0.789, 0.789, 0.789
labelsname: label_Atelectasis, Label_value 1: 0.160, 0.160, 0.160
labelsname: label_Atelectasis, Label_value 2: 0.000, 0.000, 0.000
labelsname: label_Atelectasis, Label_value 3: 0.052, 0.052, 0.052
Acc. (Correct/Total): 0.1451 (4806/33124) 
labelsname: label_Atelectasis, Epoch id: 2, Training steps: 100, Avg loss: 1.560
labelsname: label_Atelectasis, Epoch id: 2, Training steps: 200, Avg loss: 1.405
labelsname: label_Atelectasis, Epoch id: 2, Training steps: 300, Avg loss: 1.403
labelsname: label_Atelectasis, Epoch id: 2, Training steps: 400, Avg loss: 1.411
labelsname: label_Atelectasis, Epoch id: 2, Training steps: 500, Avg loss: 1.402